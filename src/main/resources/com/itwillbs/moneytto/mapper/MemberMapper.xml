<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.itwillbs.moneytto.mapper.MemberMapper">
	<!-- 회원가입 과정 -->
	<insert id="insertMember">
		INSERT INTO member
			VALUES(
				   #{member_id}
				   , #{member_name}
				   , #{member_nickname}
				   , #{member_pw}
				   , #{member_address}
				   , #{member_address_detail}
				   , #{member_bday}
				   , #{member_email}
				   , #{member_tel}
				   , '0'
				   , 'N' -- member_auth_status
				   , now() 
				   , ''	-- member_image
				   , '0' -- grade_score
				   , '0' -- declare_count
				   , '' -- 삭제예정
				   , '' -- 삭제예정
				   , POINT(${member_location})
			)
	</insert>
	
	<select id="checkId" resultType="hashmap">
		SELECT member_id
		 FROM member
			WHERE member_id = #{member_id} 
	</select>
	
	
	
	<select id="selectMember" resultType="hashmap">
		SELECT 	*
			FROM member
				WHERE member_id = #{member_id} 
	</select>
	
	<select id="selectCloseMemberList" resultType="hashmap">
		SELECT 	*
			FROM member
	</select>
	<!-- 비밀번호 재설정 -->
	<update id="renewPw">
		UPDATE member
			SET member_pw = #{member_pw}
				WHERE member_id = #{member_id}
	</update>
	
	
	<!-- 회원정보수정 -->
	<update id="updateMember" >
		UPDATE member
		SET
		member_nickname = #{member_nickname}
		,member_pw = #{member_pw2}
		,member_address = #{member_address}
		,member_address_detail = #{member_address_detail} 
		,member_bday = #{member_bday}
		,member_tel = #{member_tel}
		,member_location = POINT(${member_location})
		WHERE member_id = #{member_id}
		
	</update>
	
	
	<!-- 비밀번호 찾기 회원 인증 -->
	<select id="phoneCheck" resultType="hashmap">
		SELECT *
			FROM member
				WHERE 
					member_id = #{member_id}
					AND member_name = #{member_name}
					AND member_bday = #{member_bday}
					AND member_tel = #{member_tel}
	</select>
	<select id="selectWish" resultType="hashmap">
		SELECT 	*
			FROM wish
				WHERE member_id = #{member_id}
				AND	wish_item_code = #{wish_item_code}
	</select>
		
	<insert id="insertWish">
		INSERT INTO 
				wish
		VALUES	(
					CONCAT(#{wish_item_code},'_',#{member_id})
					, #{member_id}
					, #{wish_item_code}
					, now()	
				)
	</insert>
	<delete id="deleteWish">
		DELETE FROM 
				wish
		WHERE 
				member_id = #{member_id}
				AND	wish_item_code = #{wish_item_code}
									
	</delete>
	
	<update id="updateAuth">
		UPDATE member
			SET member_auth_status = 'Y'
			WHERE member_id = #{member_id} 
	
	</update>
	<select id="selectKakao" resultType="hashmap">
		SELECT * FROM member
			WHERE member_email = #{email}
	</select>
	<select id="findId" resultType="hashmap">
		SELECT * FROM member
			WHERE member_name = #{member_name}
				AND member_bday = #{member_bday}
				AND member_tel = #{member_tel}
	</select>
<!-- 마이페이지 조회 -->
	<select id="selectSellItemList" resultType="hashmap">
		SELECT 	
			i.*,
			w.wish_code
		FROM
			item i
		LEFT JOIN
			wish w ON i.item_code = w.wish_item_code
		WHERE
			i.member_id = #{member_id}
	</select>
	
	<select id="selectWishItemList" resultType="hashmap">
		SELECT 	
			i.*,
			w.wish_code
		FROM
			item i
		INNER JOIN
			wish w ON i.item_code = w.wish_item_code
		WHERE
			i.member_id = #{member_id}
	</select>
	
	<select id="selectBuyItemList" resultType="hashmap">
		SELECT
		 	*
		FROM
			market_paid
		WHERE
			buy_id = #{member_id} 
	</select>
<!-- 마이페이지 조회 -->	
</mapper>
